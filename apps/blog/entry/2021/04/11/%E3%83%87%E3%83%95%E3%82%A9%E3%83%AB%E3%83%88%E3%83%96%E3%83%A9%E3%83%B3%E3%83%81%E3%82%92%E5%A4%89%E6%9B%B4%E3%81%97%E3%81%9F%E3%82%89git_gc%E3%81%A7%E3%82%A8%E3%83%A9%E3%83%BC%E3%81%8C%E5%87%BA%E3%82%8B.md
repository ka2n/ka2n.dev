---
title: デフォルトブランチを変更したらgit gcでエラーが出るようになった
date: 2021-04-11T02:16:29.000Z
id: "26006613714788102"
draft: false
---
`git gc`が実行された時に以下のエラーが出るようになってしまった。


```
fatal: bad object refs/remotes/origin/HEAD
fatal: failed to run repack
```

特に特別な事はしていないし、順調にリポジトリが成長していっているだけなんだけどなぜだろう。

```
cat .git/refs/remotes/origin/HEAD
=> ref: refs/remotes/origin/master
```

数ヶ月前にデフォルトブランチを`master`から`main`に変更したんだけどなぜいまさら?
単に自動で`git gc`されていなかっただけかな。

```
echo "refs/remotes/origin/main" > .git/refs/remotes/origin/HEAD
```

として解決した。まぁ最悪ローカルが壊れても困らないので雑に対処した。
